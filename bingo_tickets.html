<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printable 75-Ball Bingo Tickets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* General setup for printability */
        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f0f0;
            margin: 0;
        }

        .a4-page {
            width: 210mm;
            height: 297mm;
            padding: 10mm;
            box-sizing: border-box;
            background: white;
            display: grid;
            /* 4 tickets wide, 2 high */
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 5px; /* Small gap between tickets */
        }

        .ticket-strip {
            display: contents; /* Allows grid items to be placed directly in the main grid */
        }
        
        /* Reggae Colors */
        .reggae-red { background-color: #FF0000; color: white; }
        .reggae-yellow { background-color: #FFD700; color: black; }
        .reggae-green { background-color: #008000; color: white; }

        .ticket {
            border: 1px solid #1a1a1a;
            padding: 5px;
            display: flex; /* Flex container for the two blocks */
            flex-direction: column;
            box-sizing: border-box;
            break-inside: avoid; /* Important for print layout */
            height: 100%;
        }

        .ticket-header {
            font-size: 10px;
            font-weight: bold;
            padding: 2px 5px;
            text-align: center;
            flex-shrink: 0;
            margin-bottom: 2px;
            border-radius: 3px;
        }

        .ticket-blocks-container {
            display: flex;
            flex-grow: 1; /* Blocks take up remaining vertical space */
            gap: 2px;
        }
        
        .number-block {
            display: grid;
            /* 5 numbers per column, 3 rows high (for B-I-N-G-O and 15 numbers total) */
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(4, 1fr); /* 1 row for header, 3 rows for numbers */
            flex: 1; /* Equal width for both blocks */
            border: 1px solid #000;
        }
        
        .number-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            border: 1px dashed #ccc;
        }

        .number-cell.header-cell {
            background-color: #008000;
            color: white;
            font-size: 10px;
            border: 1px solid #000;
        }

        /* Print-specific styles */
        @media print {
            body {
                background: white;
            }
            .a4-page {
                box-shadow: none;
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
            }
            /* Remove margins and padding on cells for tight print */
            .number-cell {
                padding: 0;
                margin: 0;
                border: 1px solid #000;
            }
            .no-print {
                display: none;
            }
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="no-print text-center mb-6">
        <a href="bingo_caller.html" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-2 px-4 rounded mb-2 inline-block">
            ‚Üê Back to Bingo Caller
        </a>
        <h1 class="text-3xl font-bold mb-2">Cool Runnings Bingo Tickets</h1>
        <p class="text-gray-600 mb-4">8 Unique Tickets Per Strip (Each ticket has 30 unique numbers).</p>
        <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
            üñ®Ô∏è Print Tickets
        </button>
        <button onclick="window.location.reload()" class="bg-gray-400 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded ml-4">
            üîÑ Generate New Strip
        </button>
        <p class="mt-4 text-red-500 font-bold">Press Ctrl+P (or Cmd+P) or the Print button to use the A4 layout.</p>
    </div>

    <div id="ticket-container" class="a4-page">
        <p class="text-center w-full">Generating tickets...</p>
    </div>

    <script>
        const NUM_TICKETS = 8;
        const NUM_PANELS = 2; // Each ticket has 2 panels (blocks)
        const NUM_NUMBERS_PER_PANEL = 15;
        // Total numbers used: 8 tickets * 2 panels * 15 numbers/panel = 240. 
        // This is a common method that allows for complex column rules across the strip.
        const RANGES = [
            { name: 'B', min: 1, max: 15 },
            { name: 'I', min: 16, max: 30 },
            { name: 'N', min: 31, max: 45 },
            { name: 'G', min: 46, max: 60 },
            { name: 'O', min: 61, max: 75 }
        ];

        // --- Core Generator Logic ---

        function generateStrip() {
            // 1. Initialize a pool for ALL numbers (1-75)
            const masterPool = [];
            for (let r of RANGES) {
                for (let n = r.min; n <= r.max; n++) {
                    masterPool.push(n);
                }
            }
            // Shuffle the pool to ensure random ticket allocation
            shuffleArray(masterPool);

            const allTickets = [];
            
            // 2. Generate 8 tickets
            for (let i = 0; i < NUM_TICKETS; i++) {
                const ticket = [];
                const numbersNeeded = NUM_PANELS * NUM_NUMBERS_PER_PANEL; // 30 numbers per ticket

                // Pull the next 30 unique numbers from the master pool
                // We use splice to pull the next 30 numbers, ensuring no repeats across the 8 tickets.
                const ticketNumbers = masterPool.splice(0, numbersNeeded);
                
                // Sort numbers by column/range
                const sortedNumbers = sortNumbersByRange(ticketNumbers);

                // 3. Distribute sorted numbers into two panels (15 each)
                let panel1Numbers = [];
                let panel2Numbers = [];

                // Distribute numbers: Each column (B,I,N,G,O) has 6 numbers total (30 / 5 columns = 6)
                // We split these 6 evenly: 3 for Panel 1, 3 for Panel 2.
                for (let r of RANGES) {
                    const colNums = sortedNumbers.filter(n => n >= r.min && n <= r.max);
                    
                    // Distribute 3 numbers to Panel 1 and 3 to Panel 2
                    if (colNums.length === 6) { // Should always be 6 for a 30-number ticket
                        panel1Numbers.push(colNums[0], colNums[2], colNums[4]); // Randomly selected 3
                        panel2Numbers.push(colNums[1], colNums[3], colNums[5]); // Remaining 3
                    } else {
                        // Fallback logic for uneven distribution (shouldn't happen with 30 numbers)
                        const mid = Math.ceil(colNums.length / 2);
                        panel1Numbers.push(...colNums.slice(0, mid));
                        panel2Numbers.push(...colNums.slice(mid));
                    }
                }

                ticket.push(formatPanel(panel1Numbers));
                ticket.push(formatPanel(panel2Numbers));
                allTickets.push(ticket);
            }

            return allTickets;
        }

        /** Formats the flat list of 15 numbers into a 5x3 grid structure (5 columns, 3 rows) */
        function formatPanel(numbers) {
            numbers.sort((a, b) => a - b);
            
            const columns = [[], [], [], [], []];
            
            for (let n of numbers) {
                const rangeIndex = RANGES.findIndex(r => n >= r.min && n <= r.max);
                columns[rangeIndex].push(n);
            }
            
            // Pad columns with 'X' (blank/empty) spaces to have 3 cells total
            const panelGrid = [];
            for (let r = 0; r < 3; r++) { // 3 rows
                const row = [];
                for (let c = 0; c < 5; c++) { // 5 columns
                    row.push(columns[c][r] !== undefined ? columns[c][r] : 'X');
                }
                panelGrid.push(row);
            }
            
            return panelGrid; // A 3x5 array (rows x columns)
        }

        /** Sorts numbers by their B-I-N-G-O range, then numerically */
        function sortNumbersByRange(numbers) {
            return numbers.sort((a, b) => {
                const rangeIndexA = RANGES.findIndex(r => a >= r.min && a <= r.max);
                const rangeIndexB = RANGES.findIndex(r => b >= r.min && b <= r.max);
                if (rangeIndexA !== rangeIndexB) {
                    return rangeIndexA - rangeIndexB;
                }
                return a - b;
            });
        }
        
        /** Standard Fisher-Yates shuffle */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- DOM Rendering ---

        function renderTickets(allTickets) {
            const container = document.getElementById('ticket-container');
            container.innerHTML = '';
            
            const headerRow = ['B', 'I', 'N', 'G', 'O'];

            allTickets.forEach((ticketData, index) => {
                const ticketEl = document.createElement('div');
                ticketEl.className = 'ticket';
                
                // Header
                const header = document.createElement('div');
                header.className = 'ticket-header reggae-red';
                header.textContent = `Cool Runnings Pub & Grill - Ticket #${index + 1}`;
                ticketEl.appendChild(header);

                const blocksContainer = document.createElement('div');
                blocksContainer.className = 'ticket-blocks-container';
                
                // Panels (Blocks)
                ticketData.forEach(panelGrid => {
                    const blockEl = document.createElement('div');
                    blockEl.className = 'number-block';
                    
                    // Render header row B-I-N-G-O
                    headerRow.forEach(letter => {
                        const cell = document.createElement('div');
                        cell.className = 'number-cell header-cell';
                        cell.textContent = letter;
                        blockEl.appendChild(cell);
                    });
                    
                    // Render 3x5 grid (15 numbers)
                    panelGrid.forEach(row => {
                        row.forEach(cellValue => {
                            const cell = document.createElement('div');
                            // Use yellow background for cells with numbers, blank otherwise
                            cell.className = 'number-cell ' + (cellValue !== 'X' ? 'reggae-yellow' : '');
                            cell.textContent = cellValue === 'X' ? '' : cellValue;
                            blockEl.appendChild(cell);
                        });
                    });
                    
                    blocksContainer.appendChild(blockEl);
                });
                
                ticketEl.appendChild(blocksContainer);
                container.appendChild(ticketEl);
            });
        }

        // Run the generator and render on load
        window.onload = () => {
            const allTickets = generateStrip();
            renderTickets(allTickets);
        };
    </script>
</body>
</html>
